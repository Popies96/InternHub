<div class="block pb-8">
    <h2 class="font-manrope font-bold text-2xl leading-9 text-gray-900 mb-3 border-b">Internships</h2>
</div>

<div *ngIf="loading" class="flex justify-center items-center h-64">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"></div>
</div>

<div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
    <span class="block sm:inline">{{ error }}</span>
</div>

<div *ngIf="!loading && !error" class="relative overflow-hidden bg-white shadow-md sm:rounded-lg">
    <div class="flex flex-col px-4 py-3 space-y-3 lg:flex-row lg:items-center lg:justify-between lg:space-y-0 lg:space-x-4">
        <div class="flex items-center flex-1 space-x-4">
            <h5>
                <span class="text-gray-500">Total Internships:</span>
                <span class="text-gray-900">{{ internships.length }}</span>
            </h5>
            <h5>
                <span class="text-gray-500">Active:</span>
            </h5>
        </div>
        <div class="flex flex-col flex-shrink-0 space-y-3 md:flex-row md:items-center lg:justify-end md:space-y-0 md:space-x-3">
            <button routerLink="/company/add_intern" type="button" class="flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-indigo-700 hover:bg-primary-800 focus:ring-4 focus:ring-indigo-300">
                Add new internship
            </button>
        </div>
    </div>
    <div class="overflow-x-auto">
        <table class="w-full text-sm text-left text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                <tr>
                    <th scope="col" class="p-4">
                        <div class="flex items-center">
                            <input id="checkbox-all" type="checkbox" class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500">
                            <label for="checkbox-all" class="sr-only">checkbox</label>
                        </div>
                    </th>
                    <th scope="col" class="px-4 py-3">Title</th>
                    <th scope="col" class="px-4 py-3">Description</th>
                    <th scope="col" class="px-4 py-3">Location</th>
                    <th scope="col" class="px-4 py-3">Duration</th>
                    <th scope="col" class="px-4 py-3">Start Date</th>
                    <th scope="col" class="px-4 py-3">End Date</th>
                    <th scope="col" class="px-4 py-3">Status</th>
                    <th scope="col" class="px-4 py-3">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let internship of internships" class="border-b hover:bg-gray-100">
                    <td class="w-4 px-4 py-3">
                        <div class="flex items-center">
                            <input [id]="'checkbox-table-search-' + internship.id" type="checkbox" (click)="$event.stopPropagation()" class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500">
                            <label [for]="'checkbox-table-search-' + internship.id" class="sr-only">checkbox</label>
                        </div>
                    </td>
                    <th scope="row" class="px-4 py-2 font-medium text-gray-900 whitespace-nowrap">
                        {{ internship.positionTitle || internship.title }}
                    </th>
                    <td class="px-4 py-2">{{ (internship.positionSummary || internship.description)?.substring(0, 50) }}{{ (internship.positionSummary || internship.description)?.length > 50 ? '...' : '' }}</td>
                    <td class="px-4 py-2">{{ internship.location }}</td>
                    <td class="px-4 py-2">{{ internship.durationInMonths }} months</td>
                    <td class="px-4 py-2">{{ internship.startDate | date:'yyyy-MM-dd' }}</td>
                    <td class="px-4 py-2">{{ internship.endDate | date:'yyyy-MM-dd' }}</td>
                    <td class="px-4 py-2">
                        <span class="text-xs font-medium px-2 py-0.5 rounded" [ngClass]="getStatusClass(internship.status)">
                            {{ internship.status || 'ACTIVE' }}
                        </span>
                    </td>
                    <td class="px-4 py-2">
                        <button 
                        type="button" 
                        (click)="editInternship(internship.id)"
                        class="text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-3 py-1.5 mr-2">
                        Edit
                      </button>
                      
                        <button 
  type="button" 
  (click)="deleteInternship(internship.id)"
  class="text-gray-800 bg-gray-100 hover:bg-red-800 hover:text-white font-medium rounded-lg text-sm px-3 py-1.5">
  Delete
</button>
                    </td>
                </tr>
                
                <tr *ngIf="internships.length === 0" class="border-b hover:bg-gray-100">
                    <td colspan="9" class="px-4 py-4 text-center text-gray-500">
                        No internships found. Create your first internship!
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <nav *ngIf="internships.length > 0" class="flex flex-col items-start justify-between p-4 space-y-3 md:flex-row md:items-center md:space-y-0" aria-label="Table navigation">
        <span class="text-sm font-normal text-gray-500">
            Showing
            <span class="font-semibold text-gray-900">1-{{ internships.length }}</span>
            of
            <span class="font-semibold text-gray-900">{{ internships.length }}</span>
        </span>
        <ul class="inline-flex items-stretch -space-x-px">
            <li>
                <button (click)="previousPage()" [disabled]="currentPage === 1" class="flex items-center justify-center h-full py-1.5 px-3 ml-0 text-gray-500 bg-white rounded-l-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 disabled:opacity-50">
                    <span class="sr-only">Previous</span>
                    <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                </button>
            </li>
            <li *ngFor="let page of [1, 2, 3]">
                <button (click)="goToPage(page)" [ngClass]="{'z-10 bg-primary-50 border-primary-300 text-primary-600': currentPage === page}" class="flex items-center justify-center px-3 py-2 text-sm leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700">
                    {{ page }}
                </button>
            </li>
            <li>
                <button (click)="nextPage()" [disabled]="currentPage * itemsPerPage >= internships.length" class="flex items-center justify-center h-full py-1.5 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 disabled:opacity-50">
                    <span class="sr-only">Next</span>
                    <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                    </svg>
                </button>
            </li>
        </ul>
    </nav>
</div>