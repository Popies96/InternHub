<div class="review-form-container">


  <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()" class="review-form">
    <!-- Reviewer Section -->
    <div class="form-group">
      <label for="reviewerId">Reviewer ID*</label>
      <input
        id="reviewerId"
        formControlName="reviewerId"
        type="number"
        class="form-control"
        placeholder="Enter reviewer ID">
      <div *ngIf="reviewForm.get('reviewerId')?.invalid && reviewForm.get('reviewerId')?.touched"
           class="error-message">
        <span *ngIf="reviewForm.get('reviewerId')?.errors?.['required']">
          Reviewer ID is required
        </span>
        <span *ngIf="reviewForm.get('reviewerId')?.errors?.['pattern']">
          Must be a positive number
        </span>
      </div>
    </div>


    <!-- Reviewee Section -->
    <div class="form-group">
      <label for="revieweeId">Reviewee ID*</label>
      <input
        id="revieweeId"
        formControlName="revieweeId"
        type="number"
        class="form-control"
        placeholder="Enter reviewee ID">
      <div *ngIf="reviewForm.get('revieweeId')?.invalid && reviewForm.get('revieweeId')?.touched"
           class="error-message">
        <span *ngIf="reviewForm.get('revieweeId')?.errors?.['required']">
          Reviewee ID is required
        </span>
        <span *ngIf="reviewForm.get('revieweeId')?.errors?.['pattern']">
          Must be a positive number
        </span>
      </div>
    </div>

    <!-- Internship Section -->
    <div class="form-group">
      <label for="internshipId">Internship ID*</label>
      <input
        id="internshipId"
        formControlName="internshipId"
        type="number"
        class="form-control"
        placeholder="Enter internship ID">
      <div *ngIf="reviewForm.get('internshipId')?.invalid && reviewForm.get('internshipId')?.touched"
           class="error-message">
        <span *ngIf="reviewForm.get('internshipId')?.errors?.['required']">
          Internship ID is required
        </span>
        <span *ngIf="reviewForm.get('internshipId')?.errors?.['pattern']">
          Must be a positive number
        </span>
      </div>
    </div>

    <!-- Enterprise Section -->
    <div class="form-group">
      <label for="enterpriseId">Enterprise ID</label>
      <input
        id="enterpriseId"
        formControlName="enterpriseId"
        type="number"
        class="form-control"
        placeholder="Enter enterprise ID (optional)">
      <div *ngIf="reviewForm.get('enterpriseId')?.invalid && reviewForm.get('enterpriseId')?.touched"
           class="error-message">
        <span *ngIf="reviewForm.get('enterpriseId')?.errors?.['pattern']">
          Must be a positive number
        </span>
      </div>
    </div>

    <!-- Comment Section -->
    <div class="form-group">
      <label for="comment">Review Comment*</label>
      <textarea
        id="comment"
        formControlName="comment"
        class="form-control"
        placeholder="Enter your review comments"
        rows="5"></textarea>
      <div *ngIf="reviewForm.get('comment')?.invalid && reviewForm.get('comment')?.touched"
           class="error-message">
        <span *ngIf="reviewForm.get('comment')?.errors?.['required']">
          Comment is required
        </span>
        <span *ngIf="reviewForm.get('comment')?.errors?.['maxlength']">
          Maximum 1000 characters allowed
        </span>
      </div>
    </div>

    <!-- Scores Section -->
    <div formArrayName="scores" class="scores-section">
      <h3>Rating Scores</h3>

      <div *ngFor="let score of scores.controls; let i = index" [formGroupName]="i" class="score-group">
        <div class="form-group">
          <label>Criteria*</label>
          <select formControlName="criteria" class="form-control">
            <option value="" disabled>Select criteria</option>
            <option *ngFor="let criteria of ratingCriteria" [value]="criteria">
              {{ criteria | titlecase }}
            </option>
          </select>
          <div *ngIf="scores.at(i).get('criteria')?.invalid && scores.at(i).get('criteria')?.touched"
               class="error-message">
            Criteria is required
          </div>
        </div>

        <div class="form-group">

          <div class="star-rating">
        <span *ngFor="let star of [1, 2, 3, 4, 5]; let index = index"
              (click)="setRating(i, index + 1)"
              [class.filled]="score.get('score')?.value >= (index + 1)"
              class="star">&#9733;</span>
          </div>
          <div *ngIf="scores.at(i).get('score')?.invalid && scores.at(i).get('score')?.touched"
               class="error-message">
        <span *ngIf="scores.at(i).get('score')?.errors?.['required']">
          Score is required
        </span>
            <span *ngIf="scores.at(i).get('score')?.errors?.['min'] || scores.at(i).get('score')?.errors?.['max']">
          Must be between 1 and 5
        </span>
          </div>
        </div>

        <button
          type="button"
          (click)="removeScore(i)"
          class="btn btn-remove"
          [disabled]="scores.length <= 1">
          <i class="fas fa-trash-alt"></i>
        </button>
      </div>

      <button
        type="button"
        (click)="addScore()"
        class="btn btn-add"
        title="Add Score">
        <i class="fas fa-plus-circle"></i>
      </button>

    </div>


    <!-- Form Actions -->
    <div class="form-actions">
      <button type="submit" class="btn-submit-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M22 2L11 13" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

    </div>
  </form>
</div>
